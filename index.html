<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>FoodDice</title>
    <style>
        body {
            margin: 0px;
            height: 100vh;
            font-family: sans-serif;
            background: lightgrey;
        }

        /*---- page-containers ----*/
        #main_wrapper {
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            position: relative;
        }
        #side_bar {
            position: absolute;
            background: #eee;
        }
        #main_container {
            height: inherit;
            width: inherit;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        #rollButton {
            z-index: 1;
            width: 180px;
            height: 180px;
            opacity: 1;
            pointer-events: auto;
            background: #eee;
        }
        /*---- page-containers ----*/


        /*---- paragraphs ----*/
        .h1 {
            font: bold 2em Arial;
        }
        .h2 {
            font: bold 1.5em Arial;
        }
        h2 {
            margin: 10px 0px;
        }
        .h3 {
            margin-top: 0;
            margin-bottom: 10px;
            font-size: 1.3em;
            border-bottom: 1px solid grey;
        }
        /*---- paragraphs ----*/


        /*---- DropdownMenu ----*/
        #logo > img {
            width: 40%;
        }
        .link {
            margin: .5rem 0;
            display: flex;
            background: none;
            border: none;
            text-decoration: none;
            color: #777;
            font-family: inherit;
            font-size: inherit;
            cursor: pointer;
            padding: 5px;
            width: 100%;
        }
        .link:hover {
            color: black;
        }
        .dropdown {
            width:100%;
        }
        .dropdown-menu {
            z-index: 5;
            position: absolute;
            left: 0;
            top: 1rem;
            width: 80vw;
            max-width: 440px;
            background: #fff;
            padding: .25rem;
            border-radius: .25rem;
            box-shadow: 0 2px 5px 0 rgba(0, 0, 0, .1);
            opacity: 0;
            pointer-events: none;
            transform: translateX(-250px);
            transition: opacity 200ms ease-in-out, transform 300ms ease-in-out;
        }
        .dropdown.active > .link + .dropdown-menu {
            opacity: 1;
            transform: translateX(0);
            pointer-events: auto;
        }
        .menuTop {
            background: #eee;
            padding: .5rem;
            border-radius: .25rem;
            margin-bottom: 5px;
        }
        .menuRow {
            display: flex;
            flex-flow: row wrap;
            justify-content: center;
            gap: 15px;
        }
        .menuDivi {
            padding: .25rem;
            border-radius: .25rem;
            width: 80vw;
            max-width: 200px;
            background: #eee;
        }
        .dropMenuInf {
            display: grid;
            grid-template-columns: 1fr auto;
            grid-column-gap: 10px;
        }
        /*---- DropdownMenu ----*/


        /*---- Suggestion ----*/
        .suggestion {
            overflow: visible;
            z-index: 5;
            position: absolute;
            width: 80%;
            top: 1rem;
            background: #fff;
            padding: .5rem;
            border-radius: .25rem;
            box-shadow: 0 2px 5px 0 rgba(0, 0, 0, .1);
            opacity: 0;
            pointer-events: none;
            transform: translateY(250px);
            transition: opacity 200ms ease-in-out, transform 300ms ease-in-out;
        }
        .suggestion.active {
            opacity: 1;
            display: inline-block;
            transform: translateY(0);
            pointer-events: auto;
        }
        .suggestionRow {
            padding: .5rem;
            display: flex;
            justify-content: center;
        }
        .Line {
            border-bottom: 1px solid grey;
            margin-bottom: 20px;
        }
        .sBilde {
            max-height: 50vh;
            max-width: 100%;
            border-radius: .25rem;
            object-fit: cover;
            box-shadow: 0 2px 5px 0 rgba(0, 0, 0, .1);
        }
        .sLinks {
            max-width: 500px;
            padding: .5rem;
            border-radius: .25rem;
            background: #ddd;
            box-shadow: 0 2px 5px 0 rgba(0, 0, 0, .1);
            transition: background .1s ease-in-out;
        }
        .sLinks:hover {
            background: #aaa;
        }
        .sLinkContent {
            height: 100%;
            width: 100%;
            border-radius: .25rem;
            background: #eee;
            cursor: pointer;
        }
        .noLinkDecor {
            text-decoration: none;
            color: #000;
        }
        .hidden {
            display: none;
        }
        /*---- Suggestion ----*/


        /*---- close-button ----*/
        .close {
            float: right;
            display: inline-block;
            padding: 2px 5px;
            background: #ccc;
            height: 30px;
            width: 30px;
            border-radius: 5px;
        }
        .close:hover {
            float: right;
            display: inline-block;
            padding: 2px 5px;
            background: #999;
            color: #fff;
        }
        /*---- close-button ----*/
    </style>
</head>
<body>
<div id="background">
    <div id="main_wrapper">
        <div id="side_bar">
            <!--<img id="logo" src="FoodDiceLogo2.png" alt="Logo">-->
            <div class="dropdown" data-dropdown>    <!-- data-tag "data-dropdown" -->
                <button class="link" data-dropdown-button>Filter</button>
                <div class="dropdown-menu">
                    <div class="menuTop">
                        <button class="link close" onclick="this.parentNode.parentNode.parentNode.classList.remove('active')">X</button>
                        <div class="h2">Filters</div>
                        <div>Select what to filer out:</div>
                    </div>
                    <div class="menuRow">
                        <div class="menuDivi">
                            <div class="h3">Vegetarian</div>
                            <div class="dropMenuInf">
                                <label for="vegetarian">Vegetarian</label>
                                <input type="checkbox" id="vegetarian" name="vegetarian">
                                <!--
                                <label for="meat">Red meat</label>
                                <input type="checkbox" id="meat" name="meat">
                                <label for="chicken">Poultry</label>
                                <input type="checkbox" id="chicken" name="chicken">
                                <label for="fish">Fish</label>
                                <input type="checkbox" id="fish" name="fish">
                                <label for="egg">Egg</label>
                                <input type="checkbox" id="egg" name="egg">
                                <label for="milk">Dairy</label>
                                <input type="checkbox" id="milk" name="milk">
                                -->
                            </div>
                        </div>
                        <div class="menuDivi">
                            <div class="h3">Allergies</div>
                            <div class="dropMenuInf">
                                <label for="gluten">Gluten</label>
                                <input type="checkbox" id="gluten" name="gluten">
                                <!--
                                <label for="2">option2</label>
                                <input type="checkbox" id="2" name="2">
                                <label for="3">option3</label>
                                <input type="checkbox" id="3" name="3">
                                -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="dropdown" data-dropdown>
                <button class="link" data-dropdown-button>Settings</button>
                <div class="dropdown-menu">
                    <div class="menuTop">
                        <button class="link close" onclick="this.parentNode.parentNode.parentNode.classList.remove('active')">X</button>
                        <div class="h2">Settings</div>
                    </div>
                    <div class="menuRow">
                        <div class="menuDivi">
                            <div class="h3">Language</div>
                            <div class="dropMenuInf">
                                <label for="eng">English</label>
                                <input type="radio" id="eng" name="lang" value="eng" checked>
                                <label for="no">Norwegian</label>
                                <input type="radio" id="no" name="lang" value="no">
                            </div>
                        </div>
                        <div class="menuDivi">
                            <div class="h3">option2</div>
                            <div class="dropMenuInf">
                                <label for="o2"></label>
                                <input type="checkbox" id="o2">
                            </div>
                        </div>
                        <div class="menuDivi">
                            <div class="h3">option3</div>
                            <div class="dropMenuInf">
                                <label for="o3"></label>
                                <input type="checkbox" id="o3">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--<div class="dropdown" data-dropdown>
                <button class="link" data-dropdown-button>Favorites</button>
                <div class="dropdown-menu">
                    <div class="dropdown-menu">
                    <div class="menuTop">
                        <button class="link close" onclick="this.parentNode.parentNode.parentNode.classList.remove('active')">X</button>
                        <div class="h2">Favorites</div>
                    </div>
                    <div class="menuRow">
                        <div class="menuDivi">
                            <div class="dropMenuInf">
                                <a href="#">Spagetti</a>
                                <a href="#">Soup</a>
                                <a href="#">Pizza</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>-->
            <div class="dropdown" data-dropdown>
                <button class="link" data-dropdown-button>Log</button>
                <div class="dropdown-menu">
                    <div class="menuTop">
                        <button class="link close" onclick="this.parentNode.parentNode.parentNode.classList.remove('active')">X</button>
                        <div class="h2">Log</div>
                    </div>
                    <div class="inf">
                        <div class="log-log">
                            <!-- tomt element -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="main_container">
            <button class="link" id="rollButton" onclick="roll()">
                <!--A dice-->
                "A dice"
            </button>
            <div id="sWindow" class="suggestion" data-dropdown>
                <button class="link close" onclick="this.parentNode.classList.remove('active')">X</button>
                <h2 id="sTitle">Test</h2>
                <div class="suggestionRow">
                    <div class="sLinks">
                        <a href="" id="sLink" target="_blank" class="noLinkDecor">
                            <div class="sLinkContent">
                                <img id="sImg" class="sBilde" src="" alt="Bilde av matrett">
                                <div id="sText" class="h3"></div>
                            </div>
                        </a>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

<!--language=JS-->
<script>
    //Opens menus
    document.addEventListener("click", e => {
        const isDropdownButton = e.target.matches("[data-dropdown-button]")
        if (!isDropdownButton && e.target.closest('[data-dropdown]') != null) return

        //holds the active menu open
        let currentDropdown
        if (isDropdownButton) {
            currentDropdown = e.target.closest("[data-dropdown]")
            currentDropdown.classList.toggle('active')
        }

        //closes all other menus
        document.querySelectorAll("[data-dropdown].active").forEach(dropdown => {
            if (dropdown === currentDropdown) return
            dropdown.classList.remove('active')
        })
    })  //End of addEventListener
    //EventListener er hentet fra Youtube
    //Web Dev Simplified. (2021, 18. september). How To Create Advanced CSS Dropdown Menus. [Video]. YouTube. https://www.youtube.com/watch?v=S-VeYcOCFZw



    //generates a random number, without immediate repeat
    let previousNumber = 0;
    let rolling = true     //rulle-prosessen skal gjøre seg ferdig før en ny prosess kan starte
    let fetchData;

    function roll() {
        if (rolling === false) {
            rolling = true
            let numberX = Math.floor(Math.random() * 34)
            if (numberX == previousNumber) {
                numberX = Math.floor(Math.random() * 34)
                previousNumber = numberX
                //console.log(numberX, "reroll");
                showMenu(numberX);
            } else {
                previousNumber = numberX
                //console.log(numberX);
                showMenu(numberX);
            }
        }
    }

    function showMenu(numberX) {

        let sWindow = document.getElementById("sWindow");
        let sTitle = document.getElementById("sTitle");
        let sLink = document.getElementById("sLink");
        let sImg = document.getElementById("sImg");
        let sText = document.getElementById("sText");

        sTitle.innerText = fetchData['Title' + numberX];
        sLink.href = fetchData['Link' + numberX];
        sImg.src = fetchData['Img' + numberX];
        sText.innerText = fetchData['Text' + numberX];

        setTimeout(function(){
            sWindow.classList.toggle('active')
            rolling = false
        }, 1000);
    }

    fetch('Suggestions/All.json')
        .then(response => response.json())
        .then(data => {
            fetchData = data;
            console.log(fetchData);
            rolling = false
        })
        .catch(function (err) {
	        console.warn('Something went wrong.', err);
        });

</script>
</body>
</html>